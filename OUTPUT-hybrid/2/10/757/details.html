<html><h3>6e08c55ad5cb7a61fa997973d5d8f9cee2f9f864,rl_coach/agents/nec_agent.py,NECAgent,learn_from_batch,#NECAgent#Any#,123
</h3><img src='987343.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        TD_targets = self.networks[&quotmain&quot].online_network.predict(batch.states(network_keys))
        bootstrapped_return_from_old_policy = batch.n_step_discounted_rewards()
        &#47&#47  only update the action that we have actually done in this transition
        for i in <a id="change">range(self.ap.network_wrappers[&quotmain&quot].batch_size)</a>:
            <a id="change">TD_targets[i, batch.actions()[i]]</a> = bootstrapped_return_from_old_policy[i]

        &#47&#47 set the gradients to fetch for the DND update
        fetches = []</code></pre><h3>After Change</h3><pre><code class='java'>
        TD_targets = self.networks[&quotmain&quot].online_network.predict(batch.states(network_keys))
        bootstrapped_return_from_old_policy = batch.n_step_discounted_rewards()
        &#47&#47  only update the action that we have actually done in this transition
        for i in <a id="change">range(batch.size)</a>:
            <a id="change">TD_targets[i, batch.actions()[i]]</a> = bootstrapped_return_from_old_policy[i]

        &#47&#47 set the gradients to fetch for the DND update
        fetches = []</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 6</div><BR><div id='size'>Non-data size: 9</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/NervanaSystems/coach/commit/6e08c55ad5cb7a61fa997973d5d8f9cee2f9f864#diff-2602cc1279cb1f4ae8702150bc61094cbf3456dc399c5451da684a5c45315cbcL123' target='_blank'>Link</a></div><div id='project'> Project Name: NervanaSystems/coach</div><div id='commit'> Commit Name: 6e08c55ad5cb7a61fa997973d5d8f9cee2f9f864</div><div id='time'> Time: </div><div id='author'> Author: null</div><div id='file'> File Name: rl_coach/agents/nec_agent.py</div><div id='class'> Class Name: NECAgent</div><div id='method'> Method Name: learn_from_batch</div><BR><BR><div id='link'><a href='https://github.com/NervanaSystems/coach/commit/6e08c55ad5cb7a61fa997973d5d8f9cee2f9f864#diff-9dc557c4f630cc8c4322615c52e2400e424432e7072c1507fb5b973b30cb264bL66' target='_blank'>Link</a></div><div id='project'> Project Name: NervanaSystems/coach</div><div id='commit'> Commit Name: 6e08c55ad5cb7a61fa997973d5d8f9cee2f9f864</div><div id='time'> Time: </div><div id='author'> Author: null</div><div id='file'> File Name: rl_coach/agents/pal_agent.py</div><div id='class'> Class Name: PALAgent</div><div id='method'> Method Name: learn_from_batch</div><BR><BR><div id='link'><a href='https://github.com/NervanaSystems/coach/commit/6e08c55ad5cb7a61fa997973d5d8f9cee2f9f864#diff-066da671cabb679c47438121cb94df4917c2d66e855cd3c1f594091ea32a63f8L53' target='_blank'>Link</a></div><div id='project'> Project Name: NervanaSystems/coach</div><div id='commit'> Commit Name: 6e08c55ad5cb7a61fa997973d5d8f9cee2f9f864</div><div id='time'> Time: </div><div id='author'> Author: null</div><div id='file'> File Name: rl_coach/agents/mmc_agent.py</div><div id='class'> Class Name: MixedMonteCarloAgent</div><div id='method'> Method Name: learn_from_batch</div><BR><BR><div id='link'><a href='https://github.com/NervanaSystems/coach/commit/6e08c55ad5cb7a61fa997973d5d8f9cee2f9f864#diff-50ffd118bcfc5f1129603bd2c22a6467fe5d3ff9e2edd5624809ba78c78a3eabL73' target='_blank'>Link</a></div><div id='project'> Project Name: NervanaSystems/coach</div><div id='commit'> Commit Name: 6e08c55ad5cb7a61fa997973d5d8f9cee2f9f864</div><div id='time'> Time: </div><div id='author'> Author: null</div><div id='file'> File Name: rl_coach/agents/dqn_agent.py</div><div id='class'> Class Name: DQNAgent</div><div id='method'> Method Name: learn_from_batch</div><BR><BR><div id='link'><a href='https://github.com/NervanaSystems/coach/commit/6e08c55ad5cb7a61fa997973d5d8f9cee2f9f864#diff-427c81b0e9663ae7d47dea2dc51bb79c68d28a5ce3e87747b2b169626fbf4dd3L44' target='_blank'>Link</a></div><div id='project'> Project Name: NervanaSystems/coach</div><div id='commit'> Commit Name: 6e08c55ad5cb7a61fa997973d5d8f9cee2f9f864</div><div id='time'> Time: </div><div id='author'> Author: null</div><div id='file'> File Name: rl_coach/agents/ddqn_agent.py</div><div id='class'> Class Name: DDQNAgent</div><div id='method'> Method Name: learn_from_batch</div><BR><BR><div id='link'><a href='https://github.com/NervanaSystems/coach/commit/6e08c55ad5cb7a61fa997973d5d8f9cee2f9f864#diff-d58fd5fa9b5c68ee450460b83ca7b2b83d4a3a0bd1228a1118be0659da767fe2L82' target='_blank'>Link</a></div><div id='project'> Project Name: NervanaSystems/coach</div><div id='commit'> Commit Name: 6e08c55ad5cb7a61fa997973d5d8f9cee2f9f864</div><div id='time'> Time: </div><div id='author'> Author: null</div><div id='file'> File Name: rl_coach/agents/qr_dqn_agent.py</div><div id='class'> Class Name: QuantileRegressionDQNAgent</div><div id='method'> Method Name: learn_from_batch</div><BR>